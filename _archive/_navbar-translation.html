<!-- Global Multilingual Navbar Script -->
<script>
// Multilingual Navbar Translation - Works from root directory
(function() {
    // Check if we're on a Polish page (either /pl/ path or pl subdomain)
    const isPolishPage = window.location.pathname.includes('/pl/') || 
                         window.location.pathname.startsWith('/pl') ||
                         (window.location.pathname === '/' && document.documentElement.lang === 'pl');
    
    // Exit if not on Polish page
    if (!isPolishPage) return;
    
    const translations = {
        // Main navbar items
        'Home': 'Strona Główna',
        'Services': 'Usługi',
        'Industries': 'Branże',
        'Portfolio': 'Portfolio',
        'Resources': 'Zasoby',
        'About': 'O Nas',
        'Contact': 'Kontakt',
        
        // Services dropdown
        'Cost Estimation & Budget Planning': 'Kosztorysowanie i Planowanie Budżetu',
        'Trade-Specific Specialist Services': 'Specjalistyczne Usługi Branżowe',
        'Automated Quantity Takeoff': 'Zautomatyzowany Przedmiar Ilości',
        'Fast-Track Cost Control': 'Szybka Kontrola Kosztów',
        'BREEAM/ESG Cost Modeling': 'Modelowanie Kosztów BREEAM/ESG',
        'MEP Infrastructure Precision': 'Precyzja Infrastruktury MEP',
        'Multi-Scenario Analysis': 'Analiza Wieloscenariuszowa',
        'Comprehensive Reporting': 'Kompleksowe Raportowanie',
        'Bid Writing & Bid Management': 'Pisanie Ofert i Zarządzanie Przetargami',
        'Traditional Quantity Takeoff': 'Tradycyjny Przedmiar Ilości',
        'Construction Data Management': 'Zarządzanie Danymi Budowlanymi',
        'Construction Logistics': 'Logistyka Budowlana',
        
        // Industries dropdown
        'Warehouses & Logistics': 'Magazyny i Logistyka',
        'Data Centers': 'Centra Danych',
        'Residential Development': 'Deweloperstwo Mieszkaniowe',
        'Remediation': 'Remediacja',
        'Commercial Development': 'Deweloperstwo Komercyjne',
        'Healthcare & Medical Facilities': 'Opieka Zdrowotna i Obiekty Medyczne',
        'Industrial & Manufacturing': 'Przemysł i Produkcja',
        'Infrastructure & Civil Works': 'Infrastruktura i Roboty Inżynieryjne',
        
        // Resources dropdown
        'BIM 2030 Guide': 'Przewodnik BIM 2030',
        'ROI Calculator': 'Kalkulator ROI',
        'Case Studies': 'Studia Przypadków',
        
        // Footer
        'All rights reserved': 'Wszelkie prawa zastrzeżone',
        'Professional BIM 5D Cost Estimation Services': 'Profesjonalne Usługi Kosztorysowania BIM 5D',
        'Quick Links': 'Szybkie Linki',
        'Privacy Policy': 'Polityka Prywatności',
        'Terms of Service': 'Warunki Usługi'
    };

    function translatePage() {
        // Only translate if we're still on a Polish page (in case of navigation)
        if (!window.location.pathname.includes('/pl/') && 
            !window.location.pathname.startsWith('/pl') && 
            document.documentElement.lang !== 'pl') {
            return;
        }
        
        // Translate menu items
        document.querySelectorAll('.menu-text').forEach(element => {
            const text = element.textContent.trim();
            if (translations[text]) {
                element.textContent = translations[text];
            }
        });
        
        // Translate dropdown items
        document.querySelectorAll('.dropdown-text').forEach(element => {
            const text = element.textContent.trim();
            if (translations[text]) {
                element.textContent = translations[text];
            }
        });
        
        // Translate footer
        const footer = document.querySelector('.nav-footer');
        if (footer) {
            const walker = document.createTreeWalker(
                footer,
                NodeFilter.SHOW_TEXT,
                null,
                false
            );
            
            let node;
            while (node = walker.nextNode()) {
                if (node.nodeValue && node.nodeValue.trim()) {
                    let text = node.nodeValue;
                    Object.keys(translations).forEach(eng => {
                        if (text.includes(eng)) {
                            text = text.replace(eng, translations[eng]);
                        }
                    });
                    node.nodeValue = text;
                }
            }
        }
        
        // Set language attribute for Polish pages
        if (isPolishPage) {
            document.documentElement.lang = 'pl';
        }
    }

    // Run immediately
    translatePage();
    
    // Also run after DOM is fully loaded
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', translatePage);
    }
    
    // And after a short delay for dynamic content
    setTimeout(translatePage, 100);
    
    // For Quarto preview - watch for navigation changes
    if (window.location.href.includes('localhost')) {
        // Use MutationObserver to catch dynamic content changes
        const observer = new MutationObserver(function(mutations) {
            // Check if navbar was added/modified
            const navbarChanged = mutations.some(mutation => {
                return mutation.target.classList && 
                       (mutation.target.classList.contains('navbar') || 
                        mutation.target.classList.contains('nav-footer'));
            });
            
            if (navbarChanged || mutations.length > 0) {
                translatePage();
            }
        });
        
        observer.observe(document.body, { 
            childList: true, 
            subtree: true,
            attributes: true,
            attributeFilter: ['class']
        });
        
        // Also listen for URL changes (for single-page navigation)
        let lastUrl = location.href; 
        new MutationObserver(() => {
            const url = location.href;
            if (url !== lastUrl) {
                lastUrl = url;
                setTimeout(translatePage, 100);
            }
        }).observe(document, {subtree: true, childList: true});
    }
})();
</script>
